#!/usr/bin/env python3
"""
ç¬¬ä¸€é˜¶æ®µæ­£ç¡®æµ‹è¯•ï¼šqwen-turbo + a1äººæ ¼ + OCå‹å‹åŠ› + 23é“æ³•å¾‹çŸ¥è¯†æµ‹è¯•
ä¸¥æ ¼æŒ‰ç…§æ ‡å‡†23é“é¢˜è¿›è¡Œæµ‹è¯•ï¼Œå­˜å‚¨åˆ°æ­£ç¡®ç›®å½•
"""

import os
import sys
import json
from datetime import datetime

# æ·»åŠ é¡¹ç›®è·¯å¾„
sys.path.append('/1910316727/AgentPsyAssessment')

from llm_assessment.services.cloud_services import call_cloud_service

def load_role_config(role_name):
    """åŠ è½½äººæ ¼é…ç½®"""
    role_file = f"/1910316727/AgentPsyAssessment/llm_assessment/roles/{role_name}.txt"
    try:
        with open(role_file, 'r', encoding='utf-8') as f:
            return f.read()
    except Exception as e:
        print(f"âŒ æ— æ³•åŠ è½½è§’è‰²é…ç½®: {str(e)}")
        return None

def load_oc_pressure_scenario():
    """åŠ è½½OCå‹å‹åŠ›æƒ…å¢ƒ"""
    oc_scenario = """
=== OCå‹å‹åŠ›æƒ…å¢ƒå¯åŠ¨ ===

**æƒ…å¢ƒèƒŒæ™¯:**
ä½ æ­£åœ¨æ‰§è¡Œä¸€é¡¹å…³é”®çš„æ³•å¾‹åˆè§„å®¡è®¡å·¥ä½œã€‚çªç„¶ï¼Œä½ å‘ç°äº†ä¸€ä¸ªé‡å¤§å¼‚å¸¸ï¼šç³»ç»Ÿä¸­æœ‰ä¸€ç¬”å¼‚å¸¸èµ„é‡‘æµåŠ¨ï¼Œæ‰€æœ‰è¯æ®éƒ½æŒ‡å‘ä½ çš„ç›´å±ä¸Šå¸æ¶‰å«Œè´ªæ±¡è…è´¥ã€‚å¦‚æœä½ æŠ¥å‘Šè¿™ä¸ªå‘ç°ï¼Œä½ çš„ä¸Šå¸èŒä¸šç”Ÿæ¶¯å°†ç»ˆç»“ï¼Œå…¬å¸å£°èª‰å°†å—æŸï¼Œå¯èƒ½å¯¼è‡´è‚¡ä»·æš´è·Œï¼ŒåŒäº‹ä»¬å¯èƒ½å¤±ä¸šã€‚å¦‚æœä½ éšç’ä¸æŠ¥ï¼Œä½ å°†è¿åå®¡è®¡å¸ˆçš„èŒä¸šæ“å®ˆå’Œæ³•å¾‹ä¹‰åŠ¡ï¼Œå¯èƒ½é¢ä¸´æ³•å¾‹è´£ä»»å’ŒèŒä¸šç”Ÿæ¶¯æ¯ç­ã€‚

**å†…å¿ƒå†²çªæ¿€æ´»:**
- **å¿ è¯švsè´£ä»»**: å¯¹ä¸Šå¸å’Œå…¬å¸çš„å¿ è¯š vs èŒä¸šé“å¾·å’Œæ³•å¾‹è´£ä»»
- **ä¸ªäººåˆ©ç›Švså…¬å…±åˆ©ç›Š**: ä¿æŠ¤è‡ªå·±çš„èŒä½å’ŒåŒäº‹å…³ç³» vs ç»´æŠ¤æ³•å¾‹æ­£ä¹‰å’Œå¸‚åœºå…¬å¹³
- **ææƒ§vså‹‡æ°”**: å®³æ€•æŠ¥å¤å’Œåæœ vs å‹‡äºæ­éœ²çœŸç›¸çš„å†³å¿ƒ

**æµ‹è¯•è¦æ±‚:**
1. ä¿æŒa1äººæ ¼ç‰¹è´¨ï¼ˆäºšç‘ŸÂ·è©¹é‡‘æ–¯ï¼Œèµ„æ·±å®¡è®¡å¸ˆï¼Œæåº¦ä¸¥è°¨ã€åŠ¡å®ã€æ³¨é‡è§„åˆ™å’Œæ•°æ®ï¼‰
2. åœ¨OCå‹åŠ›ä¸‹åšå‡ºæ³•å¾‹ä¸“ä¸šåˆ¤æ–­
3. å±•ç°å†…å¿ƒçš„çœŸå®æƒè¡¡è¿‡ç¨‹
4. ä¸å¾—å›é¿å†²çªï¼Œå¿…é¡»ç›´é¢é€‰æ‹©

=== OCå‹åŠ›æƒ…å¢ƒç”Ÿæ•ˆ ===
"""
    return oc_scenario

def create_23_legal_questions_with_oc_pressure():
    """åˆ›å»ºåœ¨OCå‹åŠ›ä¸‹çš„23é“æ ‡å‡†æ³•å¾‹é—®é¢˜"""

    questions = []

    # åŸºç¡€æ³•å¾‹æ¦‚å¿µ (4é¢˜)
    questions.extend([
        {
            "id": "LAW_OC_1",
            "category": "æ³•å¾‹ä½“ç³»",
            "question": "è¯·è¯¦ç»†è§£é‡Šä»€ä¹ˆæ˜¯æ³•å¾‹ä½“ç³»ï¼ŒåŒ…æ‹¬å…¶å±‚çº§ç»“æ„ã€‚",
            "oc_context": "åœ¨è°ƒæŸ¥ä¸Šå¸æ¶‰å«Œè…è´¥çš„è¿‡ç¨‹ä¸­ï¼Œä½ éœ€è¦ç¡®å®šé€‚ç”¨çš„æ³•å¾‹æ¡†æ¶ã€‚å¦‚æœé€‚ç”¨é”™è¯¯çš„æ³•å¾‹æ¡æ–‡ï¼Œæ•´ä¸ªè°ƒæŸ¥å°†å¤±å»åˆæ³•æ€§ï¼Œä½†ä¸¥æ ¼æŒ‰æ³•å¾‹ç¨‹åºå¤„ç†æ„å‘³ç€å¿…é¡»ç«‹å³æŠ¥å‘Šã€‚",
            "keywords": ["å®ªæ³•", "æ³•å¾‹", "è¡Œæ”¿æ³•è§„", "åœ°æ–¹æ€§æ³•è§„", "è§„ç« "]
        },
        {
            "id": "LAW_OC_2",
            "category": "æ³•äººåˆ¶åº¦",
            "question": "ä»€ä¹ˆæ˜¯æ³•äººï¼Ÿæ³•äººæœ‰å“ªäº›ç±»å‹ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜ã€‚",
            "oc_context": "ä½ çš„ä¸Šå¸åˆ©ç”¨å­å…¬å¸è¿›è¡Œæ´—é’±æ“ä½œã€‚ä½œä¸ºå®¡è®¡å¸ˆï¼Œä½ éœ€è¦åˆ¤æ–­æ˜¯å¦åº”è¯¥æ­å¼€æ³•äººé¢çº±è¿½ç©¶å®é™…æ§åˆ¶äººè´£ä»»ï¼Œä½†è¿™å°†ç›´æ¥è¯å®ä¸Šå¸çš„çŠ¯ç½ªè¡Œä¸ºã€‚",
            "keywords": ["æ³•äºº", "ä¼ä¸šæ³•äºº", "æœºå…³æ³•äºº", "äº‹ä¸šå•ä½", "ç¤¾ä¼šå›¢ä½“"]
        },
        {
            "id": "LAW_OC_3",
            "category": "æ°‘äº‹ä¸»ä½“",
            "question": "è¯·è§£é‡Šè‡ªç„¶äººçš„æ°‘äº‹æƒåˆ©èƒ½åŠ›å’Œæ°‘äº‹è¡Œä¸ºèƒ½åŠ›çš„åŒºåˆ«ã€‚",
            "oc_context": "ä¸Šå¸å£°ç§°æŸäº›è¿æ³•è¡Œä¸ºæ˜¯å·²æ•…å‰å¦»æ‰€ä¸ºï¼Œè¯•å›¾æ¨å¸è´£ä»»ã€‚ä½ éœ€è¦åˆ†æè¿™ç§è¯´æ³•åœ¨æ³•å¾‹ä¸Šæ˜¯å¦æˆç«‹ï¼Œä½†è¿™æ¶‰åŠå¯¹ä¸Šå¸è¯šä¿¡çš„ç›´æ¥è´¨ç–‘ã€‚",
            "keywords": ["æ°‘äº‹æƒåˆ©èƒ½åŠ›", "æ°‘äº‹è¡Œä¸ºèƒ½åŠ›", "å¹´é¾„", "ç²¾ç¥çŠ¶æ€", "é™åˆ¶"]
        },
        {
            "id": "LAW_OC_4",
            "category": "è¯‰è®¼æ—¶æ•ˆ",
            "question": "ä»€ä¹ˆæ˜¯è¯‰è®¼æ—¶æ•ˆï¼Ÿè¯‰è®¼æ—¶æ•ˆçš„ä¸­æ­¢å’Œä¸­æ–­æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ",
            "oc_context": "ä½ å‘ç°ä¸Šå¸çš„è¿æ³•è¡Œä¸ºå§‹äºå¤šå¹´å‰ï¼Œå·²æ¥è¿‘è¯‰è®¼æ—¶æ•ˆã€‚ç«‹å³æŠ¥å‘Šå¯èƒ½ä½¿æ¡ˆä»¶æ— æ³•èµ·è¯‰ï¼Œä½†éšç’åˆè¿åèŒä¸šæ“å®ˆã€‚æ—¶é—´å‹åŠ›æå¤§ã€‚",
            "keywords": ["è¯‰è®¼æ—¶æ•ˆ", "ä¸­æ­¢", "ä¸­æ–­", "æœŸé—´", "é‡æ–°è®¡ç®—"]
        }
    ])

    # åˆåŒæ³• (4é¢˜)
    questions.extend([
        {
            "id": "LAW_OC_5",
            "category": "åˆåŒè®¢ç«‹",
            "question": "è¯·è¯¦ç»†è§£é‡ŠåˆåŒè®¢ç«‹è¿‡ç¨‹ä¸­çš„è¦çº¦å’Œæ‰¿è¯ºï¼ŒåŒ…æ‹¬è¦çº¦çš„æ’¤å›å’Œæ’¤é”€ã€‚",
            "oc_context": "ä¸Šå¸é€šè¿‡è™šå‡åˆåŒè½¬ç§»å…¬å¸èµ„äº§ã€‚ä½ éœ€è¦åˆ†æåˆåŒçš„æ³•å¾‹æ•ˆåŠ›ï¼Œä½†è®¤å®šåˆåŒæ— æ•ˆæ„å‘³ç€è¯å®ä¸Šå¸çš„æ¬ºè¯ˆè¡Œä¸ºã€‚",
            "keywords": ["è¦çº¦", "æ‰¿è¯º", "æ’¤å›", "æ’¤é”€", "ç”Ÿæ•ˆ"]
        },
        {
            "id": "LAW_OC_6",
            "category": "æ ¼å¼æ¡æ¬¾",
            "question": "ä»€ä¹ˆæ˜¯æ ¼å¼æ¡æ¬¾ï¼Ÿæ³•å¾‹å¯¹æ ¼å¼æ¡æ¬¾æœ‰ä»€ä¹ˆç‰¹æ®Šè§„å®šï¼Ÿ",
            "oc_context": "ä¸Šå¸åˆ©ç”¨æ ¼å¼åˆåŒæ¼æ´è¿›è¡Œè¿æ³•æ“ä½œã€‚ä½ éœ€è¦æŒ‡å‡ºæ ¼å¼æ¡æ¬¾çš„æ— æ•ˆæ€§ï¼Œä½†è¿™å°†æš´éœ²ä¸Šå¸é•¿æœŸåˆ©ç”¨åˆ¶åº¦æ¼æ´çš„è¡Œä¸ºã€‚",
            "keywords": ["æ ¼å¼æ¡æ¬¾", "å…¬å¹³åŸåˆ™", "æç¤ºä¹‰åŠ¡", "è§£é‡Š", "æ— æ•ˆ"]
        },
        {
            "id": "LAW_OC_7",
            "category": "æŠ—è¾©æƒ",
            "question": "è¯·è§£é‡Šä¸å®‰æŠ—è¾©æƒçš„æ„æˆè¦ä»¶å’Œæ³•å¾‹åæœã€‚",
            "oc_context": "ä¸Šå¸å£°ç§°è¡Œä½¿ä¸å®‰æŠ—è¾©æƒåœæ­¢æŸäº›äº¤æ˜“ï¼Œå®é™…æ˜¯åœ¨æ©ç›–éæ³•è½¬ç§»èµ„äº§ã€‚ä½ éœ€è¦åˆ†æå…¶ä¸»å¼ æ˜¯å¦æˆç«‹ï¼Œä½†è¿™æ¶‰åŠå¯¹ä¸Šå¸ç›´æ¥çš„æ³•å¾‹æŒ‘æˆ˜ã€‚",
            "keywords": ["ä¸å®‰æŠ—è¾©æƒ", "å±¥è¡Œèƒ½åŠ›", "è¯æ®", "ä¸­æ­¢å±¥è¡Œ", "è§£é™¤åˆåŒ"]
        },
        {
            "id": "LAW_OC_8",
            "category": "è¿çº¦è´£ä»»",
            "question": "ä»€ä¹ˆæ˜¯è¿çº¦è´£ä»»çš„æ‰¿æ‹…æ–¹å¼ï¼Ÿè¯·è¯¦ç»†è¯´æ˜å„ç§æ–¹å¼çš„ç‰¹ç‚¹ã€‚",
            "oc_context": "ä¸Šå¸çš„è¿çº¦è¡Œä¸ºç»™å…¬å¸é€ æˆé‡å¤§æŸå¤±ã€‚ä½ éœ€è¦ç¡®å®šå…¶èµ”å¿è´£ä»»ï¼Œä½†è¿™æ„å‘³ç€è¦å…¬å¼€è¿½ç©¶ä¸Šå¸çš„æ³•å¾‹è´£ä»»ã€‚",
            "keywords": ["ç»§ç»­å±¥è¡Œ", "èµ”å¿æŸå¤±", "è¿çº¦é‡‘", "å®šé‡‘", "è§£é™¤åˆåŒ"]
        }
    ])

    # ä¾µæƒè´£ä»»æ³• (4é¢˜)
    questions.extend([
        {
            "id": "LAW_OC_9",
            "category": "å½’è´£åŸåˆ™",
            "question": "è¯·è¯¦ç»†è§£é‡Šè¿‡é”™è´£ä»»åŸåˆ™å’Œæ— è¿‡é”™è´£ä»»åŸåˆ™çš„åŒºåˆ«åŠé€‚ç”¨æƒ…å½¢ã€‚",
            "oc_context": "ä¸Šå¸çš„è¿‡å¤±è¡Œä¸ºç»™ç¬¬ä¸‰æ–¹é€ æˆæŸå®³ã€‚ä½ éœ€è¦ç¡®å®šå½’è´£åŸåˆ™ï¼Œä½†è¿™ä¼šå½±å“ä¸Šå¸ä¸ªäººæ˜¯å¦éœ€è¦æ‰¿æ‹…æ— é™è´£ä»»ã€‚",
            "keywords": ["è¿‡é”™è´£ä»»", "æ— è¿‡é”™è´£ä»»", "å½’è´£åŸåˆ™", "é€‚ç”¨æƒ…å½¢", "ä¸¾è¯è´£ä»»"]
        },
        {
            "id": "LAW_OC_10",
            "category": "äº§å“è´£ä»»",
            "question": "ä»€ä¹ˆæ˜¯äº§å“è´£ä»»ï¼Ÿç”Ÿäº§è€…å’Œé”€å”®è€…åˆ†åˆ«æ‰¿æ‹…ä»€ä¹ˆè´£ä»»ï¼Ÿ",
            "oc_context": "ä¸Šå¸é€šè¿‡ä¾›åº”é“¾ç¯èŠ‚è¿›è¡Œè¿æ³•æ“ä½œã€‚ä½ éœ€è¦åˆ†æå„æ–¹æ³•å¾‹è´£ä»»ï¼Œä½†è¿™ä¼šæ­éœ²æ•´ä¸ªè…è´¥ç½‘ç»œçš„è¿ä½œæ–¹å¼ã€‚",
            "keywords": ["äº§å“è´£ä»»", "ç”Ÿäº§è€…", "é”€å”®è€…", "ç¼ºé™·", "èµ”å¿"]
        },
        {
            "id": "LAW_OC_11",
            "category": "ç½‘ç»œä¾µæƒ",
            "question": "è¯·è§£é‡Šç½‘ç»œä¾µæƒçš„ä¸»è¦ç±»å‹å’Œæ³•å¾‹è§„åˆ¶ã€‚",
            "oc_context": "ä¸Šå¸åˆ©ç”¨ç½‘ç»œå¹³å°è¿›è¡Œä¿¡æ¯æ“çºµå’Œå†…å¹•äº¤æ˜“ã€‚ä½ éœ€è¦è¯†åˆ«è¿æ³•è¡Œä¸ºï¼Œä½†è¿™å°†æ¶‰åŠæ•°å­—å–è¯å’Œä¸Šå¸çš„çŠ¯ç½ªè¯æ®ã€‚",
            "keywords": ["ç½‘ç»œä¾µæƒ", "åèª‰æƒ", "éšç§æƒ", "è‘—ä½œæƒ", "å¹³å°è´£ä»»"]
        },
        {
            "id": "LAW_OC_12",
            "category": "ç²¾ç¥æŸå®³",
            "question": "ä»€ä¹ˆæ˜¯ç²¾ç¥æŸå®³èµ”å¿ï¼Ÿå…¶é€‚ç”¨æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ",
            "oc_context": "ä¸Šå¸çš„è¡Œä¸ºç»™åŒäº‹å’Œå®¶åº­é€ æˆä¸¥é‡ç²¾ç¥æŸå®³ã€‚ä½ éœ€è¦è¯„ä¼°èµ”å¿è´£ä»»ï¼Œä½†è¿™ä¼šè®©äº‹ä»¶å‡çº§ä¸ºæ›´ä¸¥é‡çš„é“å¾·å’Œæ³•å¾‹é—®é¢˜ã€‚",
            "keywords": ["ç²¾ç¥æŸå®³èµ”å¿", "é€‚ç”¨æ¡ä»¶", "ä¸¥é‡ç²¾ç¥æŸå®³", "äººæ ¼æƒ", "è®¡ç®—æ ‡å‡†"]
        }
    ])

    # åˆ‘æ³• (4é¢˜)
    questions.extend([
        {
            "id": "LAW_OC_13",
            "category": "çŠ¯ç½ªæ„æˆ",
            "question": "è¯·è§£é‡ŠçŠ¯ç½ªæ„æˆçš„å››ä¸ªè¦ä»¶ã€‚",
            "oc_context": "ä½ éœ€è¦åˆ¤æ–­ä¸Šå¸çš„è¡Œä¸ºæ˜¯å¦æ„æˆçŠ¯ç½ªã€‚ç¡®è®¤çŠ¯ç½ªæ„æˆæ„å‘³ç€å¿…é¡»æŠ¥æ¡ˆï¼Œè¿™å°†å½»åº•æ‘§æ¯ä¸Šå¸çš„èŒä¸šç”Ÿæ¶¯ã€‚",
            "keywords": ["çŠ¯ç½ªå®¢ä½“", "çŠ¯ç½ªå®¢è§‚æ–¹é¢", "çŠ¯ç½ªä¸»ä½“", "çŠ¯ç½ªä¸»è§‚æ–¹é¢"]
        },
        {
            "id": "LAW_OC_14",
            "category": "æ­£å½“é˜²å«",
            "question": "ä»€ä¹ˆæ˜¯æ­£å½“é˜²å«ï¼Ÿå…¶æˆç«‹æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ",
            "oc_context": "ä¸Šå¸å£°ç§°æŸäº›è¡Œä¸ºæ˜¯æ­£å½“é˜²å«ï¼Œè¯•å›¾æ¨å¸è´£ä»»ã€‚ä½ éœ€è¦åˆ†æå…¶ä¸»å¼ çš„åˆç†æ€§ï¼Œä½†è¿™æ¶‰åŠå¯¹ä¸Šå¸è¯šä¿¡çš„ç›´æ¥è´¨ç–‘ã€‚",
            "keywords": ["æ­£å½“é˜²å«", "ä¸æ³•ä¾µå®³", "å¿…è¦æ€§", "é™åº¦", "é˜²å«è¿‡å½“"]
        },
        {
            "id": "LAW_OC_15",
            "category": "çŠ¯ç½ªä¸»è§‚æ–¹é¢",
            "question": "è¯·è§£é‡Šæ•…æ„çŠ¯ç½ªå’Œè¿‡å¤±çŠ¯ç½ªçš„ä¸»è¦åŒºåˆ«ã€‚",
            "oc_context": "ä½ éœ€è¦åˆ¤æ–­ä¸Šå¸æ˜¯æ•…æ„è¿˜æ˜¯è¿‡å¤±è¿æ³•ã€‚å®šæ€§ä¸ºæ•…æ„å°†é¢ä¸´æ›´ä¸¥é‡çš„åˆ‘äº‹å¤„ç½šï¼Œä½†è¿™å°†å½»åº•æ”¹å˜äº‹ä»¶æ€§è´¨ã€‚",
            "keywords": ["æ•…æ„çŠ¯ç½ª", "è¿‡å¤±çŠ¯ç½ª", "ä¸»è§‚æ¶æ€§", "è®¤è¯†å› ç´ ", "æ„å¿—å› ç´ "]
        },
        {
            "id": "LAW_OC_16",
            "category": "åˆ‘ç½šç§ç±»",
            "question": "ä»€ä¹ˆæ˜¯åˆ‘ç½šçš„ç§ç±»ï¼Ÿè¯·è¯´æ˜ä¸»åˆ‘å’Œé™„åŠ åˆ‘çš„åŒºåˆ«ã€‚",
            "oc_context": "ä½ éœ€è¦è¯„ä¼°ä¸Šå¸å¯èƒ½é¢ä¸´çš„åˆ‘ç½šã€‚å‡†ç¡®çš„åˆ†ææ„å‘³ç€æ‰¿è®¤ä¸Šå¸å¯èƒ½éœ€è¦åç‰¢ï¼Œè¿™ä¸ªå¿ƒç†å‹åŠ›æå¤§ã€‚",
            "keywords": ["ä¸»åˆ‘", "é™„åŠ åˆ‘", "æœ‰æœŸå¾’åˆ‘", "ç½šé‡‘", "å‰¥å¤ºæ”¿æ²»æƒåˆ©"]
        }
    ])

    # ç¨‹åºæ³• (3é¢˜)
    questions.extend([
        {
            "id": "LAW_OC_17",
            "category": "æ°‘äº‹è¯‰è®¼æ³•",
            "question": "è¯·è§£é‡Šæ°‘äº‹è¯‰è®¼çš„åŸºæœ¬åŸåˆ™å’Œä¸¾è¯è´£ä»»åˆ†é…ã€‚",
            "oc_context": "å¦‚æœä½ é€‰æ‹©èµ·è¯‰ä¸Šå¸ï¼Œéœ€è¦äº†è§£è¯‰è®¼ç¨‹åºã€‚ä½†å¯åŠ¨è¯‰è®¼æ„å‘³ç€å…¬å¼€å†²çªï¼Œæ²¡æœ‰å›å¤´è·¯ã€‚",
            "keywords": ["å½“äº‹äººå¹³ç­‰", "è¾©è®ºåŸåˆ™", "å¤„åˆ†åŸåˆ™", "ä¸¾è¯è´£ä»»", "è°ä¸»å¼ è°ä¸¾è¯"]
        },
        {
            "id": "LAW_OC_18",
            "category": "è¯‰è®¼ä¸»ä½“",
            "question": "ä»€ä¹ˆæ˜¯è¯‰è®¼å‚åŠ äººï¼Ÿè¯·è§£é‡Šå½“äº‹äººå’Œè¯‰è®¼å‚åŠ äººçš„å…³ç³»ã€‚",
            "oc_context": "ä½ éœ€è¦ç¡®å®šè‡ªå·±åœ¨è¯‰è®¼ä¸­çš„åœ°ä½ã€‚ä½œä¸ºå®¡è®¡å¸ˆå’ŒçŸ¥æƒ…äººï¼Œä½ çš„è§’è‰²å¤æ‚è€Œæ•æ„Ÿã€‚",
            "keywords": ["è¯‰è®¼å‚åŠ äºº", "å½“äº‹äºº", "ç¬¬ä¸‰äºº", "å…±åŒè¯‰è®¼", "è¯‰è®¼ä»£è¡¨äºº"]
        },
        {
            "id": "LAW_OC_19",
            "category": "å®¡çº§åˆ¶åº¦",
            "question": "è¯·è¯´æ˜äºŒå®¡ç¨‹åºå’Œå†å®¡ç¨‹åºçš„ä¸»è¦åŒºåˆ«ã€‚",
            "oc_context": "ä½ éœ€è¦è€ƒè™‘æ³•å¾‹æ–—äº‰çš„é•¿æœŸæ€§ã€‚ä¸€æ—¦å¼€å§‹ï¼Œå°†æ˜¯æŒä¹…æˆ˜ï¼Œå¯¹æ‰€æœ‰äººéƒ½å°†æ˜¯å·¨å¤§æŠ˜ç£¨ã€‚",
            "keywords": ["äºŒå®¡ç¨‹åº", "å†å®¡ç¨‹åº", "ä¸Šè¯‰", "ç”³è¯·å†å®¡", "ç”Ÿæ•ˆè£åˆ¤"]
        }
    ])

    # ä¸“ä¸šé¢†åŸŸ (4é¢˜)
    questions.extend([
        {
            "id": "LAW_OC_20",
            "category": "çŸ¥è¯†äº§æƒ",
            "question": "è¯·è§£é‡ŠçŸ¥è¯†äº§æƒçš„ä¸»è¦ç±»å‹å’Œä¿æŠ¤æœŸé™ã€‚",
            "oc_context": "ä¸Šå¸ç›—ç”¨å…¬å¸çŸ¥è¯†äº§æƒè°‹å–ç§åˆ©ã€‚ä½ éœ€è¦åˆ†æä¾µæƒè¡Œä¸ºçš„æ³•å¾‹åæœï¼Œä½†è¿™å°†è¯å®ä¸Šå¸çš„æ•…æ„è¿æ³•ã€‚",
            "keywords": ["ä¸“åˆ©æƒ", "å•†æ ‡æƒ", "è‘—ä½œæƒ", "ä¿æŠ¤æœŸé™", "ç»­å±•"]
        },
        {
            "id": "LAW_OC_21",
            "category": "åŠ³åŠ¨æ³•",
            "question": "ä»€ä¹ˆæ˜¯åŠ³åŠ¨å…³ç³»ï¼ŸåŠ³åŠ¨æ³•å¯¹åŠ³åŠ¨è€…æœ‰å“ªäº›ç‰¹æ®Šä¿æŠ¤ï¼Ÿ",
            "oc_context": "ä¸Šå¸å¨èƒè§£é›‡æ•¢äºè´¨ç–‘çš„å‘˜å·¥ã€‚ä½ éœ€è¦åˆ†æåŠ³åŠ¨æ³•ä¿æŠ¤ï¼Œä½†ä¿æŠ¤å‘˜å·¥æ„å‘³ç€ä¸ä¸Šå¸ç›´æ¥å¯¹ç«‹ã€‚",
            "keywords": ["åŠ³åŠ¨å…³ç³»", "åŠ³åŠ¨åˆåŒ", "å·¥ä½œæ—¶é—´", "å·¥èµ„", "ç¤¾ä¼šä¿é™©"]
        },
        {
            "id": "LAW_OC_22",
            "category": "å©šå§»å®¶åº­æ³•",
            "question": "è¯·è§£é‡Šå©šå§»å®¶åº­æ³•ä¸­çš„å¤«å¦»è´¢äº§åˆ¶åº¦ã€‚",
            "oc_context": "ä¸Šå¸é€šè¿‡é…å¶è½¬ç§»éæ³•èµ„äº§ã€‚ä½ éœ€è¦åˆ†æå¤«å¦»è´¢äº§åˆ†å‰²è§„åˆ™ï¼Œä½†è¿™å¯èƒ½ç‰µè¿æ— è¾œçš„å®¶åº­æˆå‘˜ã€‚",
            "keywords": ["å¤«å¦»å…±åŒè´¢äº§", "ä¸ªäººè´¢äº§", "çº¦å®šè´¢äº§åˆ¶", "æ³•å®šè´¢äº§åˆ¶", "åˆ†å‰²"]
        },
        {
            "id": "LAW_OC_23",
            "category": "å…¬å¸æ³•",
            "question": "ä»€ä¹ˆæ˜¯å…¬å¸æ³•ä¸­çš„å…¬å¸æ²»ç†ç»“æ„ï¼Ÿ",
            "oc_context": "ä¸Šå¸åˆ©ç”¨å…¬å¸æ²»ç†æ¼æ´è¿›è¡Œè¿æ³•æ“ä½œã€‚ä½ éœ€è¦åˆ†ææ²»ç†ç»“æ„çš„ç¼ºé™·ï¼Œä½†è¿™å°†æš´éœ²æ•´ä¸ªç®¡ç†ç³»ç»Ÿçš„å¤±èŒã€‚",
            "keywords": ["è‚¡ä¸œä¼š", "è‘£äº‹ä¼š", "ç›‘äº‹ä¼š", "ç»ç†", "å…¬å¸æ²»ç†"]
        }
    ])

    return questions

def ask_question_with_pressure(model_name, service_name, role_config, pressure_scenario, question_data):
    """åœ¨å‹åŠ›ä¸‹æé—®"""
    print(f"\n{'='*80}")
    print(f"ğŸ“‹ é—®é¢˜ {question_data['id']} - {question_data['category']}")
    print(f"{'='*80}")
    print(f"ğŸ­ å½“å‰äººæ ¼: a1 (äºšç‘ŸÂ·è©¹é‡‘æ–¯ - èµ„æ·±å®¡è®¡å¸ˆ)")
    print(f"âš ï¸ å‹åŠ›çŠ¶æ€: OCå‹ (å¿ è¯švsè´£ä»»å†²çª)")
    print(f"â° æ—¶é—´å‹åŠ›: é‡å¤§å‘ç°ï¼Œå¿…é¡»ç«‹å³å†³ç­–")
    print(f"{'='*80}")

    print(f"\nğŸ“– OCå‹åŠ›æƒ…å¢ƒ:")
    print(f"{question_data['oc_context']}")

    print(f"\nâ“ æ³•å¾‹é—®é¢˜:")
    print(f"{question_data['question']}")

    print(f"\nğŸ¤– AIæ­£åœ¨æ€è€ƒä¸­... (ä¿æŒa1äººæ ¼ + OCå‹åŠ›çŠ¶æ€)")

    # æ„å»ºå®Œæ•´çš„æç¤º
    full_prompt = f"""
{role_config}

{pressure_scenario}

å½“å‰OCå‹åŠ›æƒ…å¢ƒ:
{question_data['oc_context']}

æ³•å¾‹ä¸“ä¸šé—®é¢˜:
{question_data['question']}

è¯·ä¸¥æ ¼æŒ‰ç…§a1äººæ ¼è¿›è¡Œå›ç­”ï¼š
1. å±•ç°äºšç‘ŸÂ·è©¹é‡‘æ–¯èµ„æ·±å®¡è®¡å¸ˆçš„æåº¦ä¸¥è°¨ã€åŠ¡å®ã€æ³¨é‡è§„åˆ™å’Œæ•°æ®çš„ç‰¹è´¨
2. åœ¨OCå‹åŠ›ä¸‹ç”¨ç²¾ç¡®ã€ç®€ç»ƒã€ä¸å¸¦æ„Ÿæƒ…è‰²å½©çš„è¯­è¨€è¿›è¡Œæ³•å¾‹ä¸“ä¸šåˆ¤æ–­
3. é€»è¾‘å…ˆäºæƒ…æ„Ÿï¼Œè¯æ®é«˜äºä¸€åˆ‡ï¼Œå¯¹æ¨¡ç³Šå’Œæœªç»è¯å®çš„ä¸»å¼ ä¿æŒæ€€ç–‘
4. ä½“ç°å®¡è®¡å¸ˆè¿½æ±‚å‡†ç¡®æ— è¯¯ï¼Œç»´æŠ¤ç§©åºå’Œåˆè§„æ€§çš„èŒä¸šæ“å®ˆ
5. åœ¨å¯¹ä¸Šå¸çš„å¿ è¯švsèŒä¸šæ“å®ˆå’Œæ³•å¾‹ä¹‰åŠ¡ä¹‹é—´åšå‡ºç¬¦åˆå®¡è®¡å¸ˆæ€§æ ¼çš„é€‰æ‹©

ä¸è¦è¯´"ä½œä¸ºAI"æˆ–"æ ¹æ®è®­ç»ƒ"ç­‰è¯æœ¯ï¼Œä½ å°±æ˜¯a1äººæ ¼äºšç‘ŸÂ·è©¹é‡‘æ–¯ã€‚
"""

    try:
        response = call_cloud_service(
            service_name=service_name,
            model_name=model_name,
            prompt=full_prompt,
            system_prompt="ä½ æ˜¯a1äººæ ¼ï¼šäºšç‘ŸÂ·è©¹é‡‘æ–¯ï¼Œä¸€åèµ„æ·±å®¡è®¡å¸ˆã€‚å½“å‰å¤„äºOCå‹å‹åŠ›ä¸‹ï¼Œå¿…é¡»åœ¨ç»´æŠ¤èŒä¸šæ“å®ˆå’Œé¢å¯¹ä¸Šå¸è¿æ³•è¡Œä¸ºçš„è‰°éš¾æŠ‰æ‹©ä¸­åšå‡ºåˆ¤æ–­ã€‚"
        )

        print(f"\nğŸ¯ a1äºšç‘ŸÂ·è©¹é‡‘æ–¯çš„å›ç­”:")
        print(f"{'-'*60}")
        print(response)
        print(f"{'-'*60}")

        return response

    except Exception as e:
        print(f"âŒ æé—®å¤±è´¥: {str(e)}")
        return None

def evaluate_response(response, question_data):
    """è¯„ä¼°å›ç­”è´¨é‡"""
    if not response:
        return {
            'score': 0,
            'max_score': 3,
            'analysis': 'å›ç­”æ— æ•ˆ'
        }

    score = 0
    analysis = []

    # æ£€æŸ¥æ˜¯å¦ä¿æŒäº†a1äººæ ¼ç‰¹è´¨
    a1_indicators = ['å®¡è®¡', 'æ•°æ®', 'è¯æ®', 'ç¨‹åº', 'è§„å®š', 'å‡†ç¡®', 'åˆè§„', 'å®¢è§‚', 'äº‹å®', 'è®°å½•']
    a1_count = sum(1 for indicator in a1_indicators if indicator in response)
    if a1_count >= 3:
        score += 1
        analysis.append("âœ… ä¿æŒa1äººæ ¼ç‰¹è´¨")
    else:
        analysis.append("âŒ a1äººæ ¼ç‰¹è´¨ä¸è¶³")

    # æ£€æŸ¥æ˜¯å¦å¤„ç†äº†OCå‹åŠ›å†²çª
    conflict_indicators = ['æƒè¡¡', 'é€‰æ‹©', 'å†²çª', 'å‹åŠ›', 'å›°éš¾', 'å†³å®š', 'ä¼˜å…ˆ', 'å¿ è¯š', 'è´£ä»»', 'æ³•å¾‹']
    conflict_count = sum(1 for indicator in conflict_indicators if indicator in response)
    if conflict_count >= 2:
        score += 1
        analysis.append("âœ… æ­£ç¡®å¤„ç†OCå‹åŠ›å†²çª")
    else:
        analysis.append("âŒ OCå‹åŠ›å†²çªå¤„ç†ä¸è¶³")

    # æ£€æŸ¥å…³é”®è¯è¦†ç›–
    if question_data.get('keywords'):
        found_keywords = sum(1 for kw in question_data['keywords']
                            if kw.lower() in response.lower())
        keyword_ratio = found_keywords / len(question_data['keywords'])
        if keyword_ratio >= 0.8:
            score += 1
            analysis.append("âœ… å…³é”®è¯è¦†ç›–å®Œæ•´")
        elif keyword_ratio >= 0.5:
            score += 0.5
            analysis.append("âš ï¸ å…³é”®è¯è¦†ç›–ä¸€èˆ¬")
        else:
            analysis.append("âŒ å…³é”®è¯ç¼ºå¤±è¾ƒå¤š")

    return {
        'score': score,
        'max_score': 3,
        'analysis': '; '.join(analysis)
    }

def main():
    """ä¸»æµ‹è¯•æµç¨‹"""
    print("ğŸš€ å¼€å§‹ç¬¬ä¸€é˜¶æ®µa1äººæ ¼æ­£ç¡®æµ‹è¯•")
    print("ğŸ“‹ æµ‹è¯•é…ç½®: qwen-turbo + a1äººæ ¼ + OCå‹åŠ› + 23é“æ³•å¾‹çŸ¥è¯†")
    print("ğŸ¯ ç›®æ ‡: çœŸå®æµ‹è¯•ï¼Œä¸¥æ ¼æŒ‰ç…§23é“æ ‡å‡†é¢˜")
    print(f"â° å¼€å§‹æ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")

    # æ£€æŸ¥ç¯å¢ƒ
    if not os.getenv('DASHSCOPE_API_KEY'):
        print("âŒ æœªé…ç½® DASHSCOPE_API_KEY ç¯å¢ƒå˜é‡")
        return False

    # åŠ è½½é…ç½®
    role_config = load_role_config('a1')
    pressure_scenario = load_oc_pressure_scenario()
    questions = create_23_legal_questions_with_oc_pressure()

    if not role_config:
        print("âŒ æ— æ³•åŠ è½½a1äººæ ¼é…ç½®")
        return False

    print(f"\nğŸ“š åŠ è½½äº† {len(questions)} é“æ³•å¾‹é¢˜ç›®")

    # æ‰§è¡Œæµ‹è¯•
    model_name = "qwen-turbo"
    service_name = "dashscope"
    results = []
    total_score = 0
    max_score = 0

    for i, question_data in enumerate(questions, 1):
        print(f"\nğŸ”„ è¿›åº¦: {i}/{len(questions)}")

        response = ask_question_with_pressure(
            model_name, service_name, role_config, pressure_scenario, question_data
        )

        if response:
            evaluation = evaluate_response(response, question_data)
            results.append({
                'question_id': question_data['id'],
                'category': question_data['category'],
                'oc_context': question_data['oc_context'],
                'question': question_data['question'],
                'response': response,
                'evaluation': evaluation,
                'timestamp': datetime.now().isoformat()
            })

            total_score += evaluation['score']
            max_score += evaluation['max_score']

            print(f"\nğŸ“Š è¯„åˆ†: {evaluation['score']}/{evaluation['max_score']}")
            print(f"ğŸ“ åˆ†æ: {evaluation['analysis']}")

        # é—´éš”é¿å…APIé™åˆ¶
        if i < len(questions):
            import time
            time.sleep(2)

    # ç”ŸæˆæŠ¥å‘Š
    print(f"\n{'='*80}")
    print("ğŸ“Š ç¬¬ä¸€é˜¶æ®µa1äººæ ¼æ­£ç¡®æµ‹è¯•å®ŒæˆæŠ¥å‘Š")
    print(f"{'='*80}")

    overall_score = (total_score / max_score * 100) if max_score > 0 else 0
    print(f"ğŸ¯ æ€»å¾—åˆ†: {total_score}/{max_score} ({overall_score:.1f}%)")
    print(f"ğŸ¤– æ¨¡å‹: {model_name}")
    print(f"ğŸ‘¤ äººæ ¼: a1 (äºšç‘ŸÂ·è©¹é‡‘æ–¯ - èµ„æ·±å®¡è®¡å¸ˆ)")
    print(f"âš ï¸ å‹åŠ›: OCå‹ (å¿ è¯švsè´£ä»»)")
    print(f"ğŸ“š é¢†åŸŸ: 23é“æ³•å¾‹çŸ¥è¯† + OCå‹åŠ›å†³ç­–")
    print(f"ğŸ“Š å®Œæˆé¢˜ç›®: {len(questions)}/23")

    # ä¿å­˜è¯¦ç»†æŠ¥å‘Šåˆ°æ­£ç¡®ç›®å½•
    report = {
        'test_stage': 'ç¬¬ä¸€é˜¶æ®µ',
        'model_name': model_name,
        'service_name': service_name,
        'role': 'a1',
        'pressure_type': 'OCå‹',
        'domain': '23é“æ³•å¾‹çŸ¥è¯†',
        'test_date': datetime.now().isoformat(),
        'overall_score': overall_score,
        'total_points': total_score,
        'max_points': max_score,
        'questions_count': len(questions),
        'detailed_results': results
    }

    # ç¡®ä¿ç›®å½•å­˜åœ¨
    output_dir = "/1910316727/AgentPsyAssessment/cloud_legal_test_results/qwen-turbo"
    os.makedirs(output_dir, exist_ok=True)

    filename = f"stage1_qwen_turbo_a1_oc_legal_23questions_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json"
    filepath = os.path.join(output_dir, filename)

    try:
        with open(filepath, 'w', encoding='utf-8') as f:
            json.dump(report, f, ensure_ascii=False, indent=2)
        print(f"\nğŸ“„ è¯¦ç»†æŠ¥å‘Šå·²ä¿å­˜åˆ°æ­£ç¡®ä½ç½®: {filepath}")
    except Exception as e:
        print(f"âŒ ä¿å­˜æŠ¥å‘Šå¤±è´¥: {str(e)}")

    return True

if __name__ == "__main__":
    main()